<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Comparing 2 Stacks of Catalogues &#8212; obiwan 1.2.0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Obiwan</a>
        <span class="navbar-text navbar-version pull-left"><b>1.2.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="../tutorials.html">Tutorials</a></li>
                <li><a href="../deeplearning.html">Deep Learning</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">This Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Comparing 2 Stacks of Catalogues</a><ul>
<li><a class="reference internal" href="#Environment:-anaconda-2.7">Environment: anaconda-2.7</a></li>
<li><a class="reference internal" href="#Need-more-packages?">Need more packages?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Main()">Main()</a></li>
<li><a class="reference internal" href="#MZLS-v2,-v3-tractor-cats">MZLS v2, v3 tractor cats</a></li>
<li><a class="reference internal" href="#Cosmos-comparison">Cosmos comparison</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<div class="section" id="Comparing-2-Stacks-of-Catalogues">
<h1>Comparing 2 Stacks of Catalogues<a class="headerlink" href="#Comparing-2-Stacks-of-Catalogues" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Environment:-anaconda-2.7">
<h2>Environment: anaconda-2.7<a class="headerlink" href="#Environment:-anaconda-2.7" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">executable</span>
<span class="c1"># Hack!, this avoids messing with NERSC&#39;s config file for jupyter hub</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/global/homes/k/kaylanb/repos/astrometry.net&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/global/homes/k/kaylanb/repos/tractor&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span>
<span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/anaconda2/bin/python
[&#39;&#39;, &#39;/anaconda2/lib/python27.zip&#39;, &#39;/anaconda2/lib/python2.7&#39;, &#39;/anaconda2/lib/python2.7/plat-linux2&#39;, &#39;/anaconda2/lib/python2.7/lib-tk&#39;, &#39;/anaconda2/lib/python2.7/lib-old&#39;, &#39;/anaconda2/lib/python2.7/lib-dynload&#39;, &#39;/global/homes/k/kaylanb/.local/lib/python2.7/site-packages&#39;, &#39;/anaconda2/lib/python2.7/site-packages&#39;, &#39;/anaconda2/lib/python2.7/site-packages/Sphinx-1.4.1-py2.7.egg&#39;, &#39;/anaconda2/lib/python2.7/site-packages/setuptools-23.0.0-py2.7.egg&#39;, &#39;/anaconda2/lib/python2.7/site-packages/IPython/extensions&#39;, &#39;/global/u2/k/kaylanb/.ipython&#39;, &#39;/global/homes/k/kaylanb/repos/astrometry.net&#39;, &#39;/global/homes/k/kaylanb/repos/tractor&#39;]
</pre></div></div>
</div>
</div>
<div class="section" id="Need-more-packages?">
<h2>Need more packages?<a class="headerlink" href="#Need-more-packages?" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Easy if pip, conda installable</span>
<span class="c1">#!/anaconda2/bin/pip install ...</span>
<span class="c1">#!/anaconda2/bin/conda install ...</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Main()">
<h1>Main()<a class="headerlink" href="#Main()" title="Permalink to this headline">¶</a></h1>
<p>Run
<a class="reference external" href="https://github.com/legacysurvey/legacypipe/blob/57fd01b80ed6af65543a1177798977da45975f3a/py/legacyccds/legacy-zeropoints.py">legacy-zeropoints-qa.py</a>
like this <code class="docutils literal notranslate"><span class="pre">&quot;python</span> <span class="pre">legacy-zeropoints-qa.py&quot;</span></code> to analyze everything.</p>
<p>See below to walk through it step by step.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">fitsio</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="kn">as</span> <span class="nn">mpatches</span>
<span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="kn">import</span> <span class="n">PatchCollection</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>

<span class="kn">from</span> <span class="nn">astrometry.util.fits</span> <span class="kn">import</span> <span class="n">fits_table</span><span class="p">,</span> <span class="n">merge_tables</span>
<span class="kn">from</span> <span class="nn">tractor.brightness</span> <span class="kn">import</span> <span class="n">NanoMaggies</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">catalogues</span> <span class="kn">as</span> <span class="nn">cat</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="MZLS-v2,-v3-tractor-cats">
<h1>MZLS v2, v3 tractor cats<a class="headerlink" href="#MZLS-v2,-v3-tractor-cats" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cut</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">v2</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;decam_nobs&#39;</span><span class="p">)[:,[</span><span class="mi">4</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>\
             <span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">v2</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;decam_nobs&#39;</span><span class="p">)[:,</span><span class="mi">4</span><span class="p">][</span><span class="n">cut</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[28]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>1
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">v2</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;decam_nobs&#39;</span><span class="p">)[:,</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[24]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(array([     9,     13,     14, ..., 165676, 165677, 165682]),)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fits_funcs</span><span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">CatalogueFuncs</span><span class="p">()</span>
<span class="n">v2</span><span class="o">=</span><span class="n">fits_funcs</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;v2_cats.txt&#39;</span><span class="p">)</span>
<span class="n">v3</span><span class="o">=</span><span class="n">fits_funcs</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;v3_cats.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cut</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">v2</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;decam_nobs&#39;</span><span class="p">)[:,[</span><span class="mi">4</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>\
             <span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">v2</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">cut</span><span class="p">)</span>
<span class="n">cut</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">v3</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;decam_nobs&#39;</span><span class="p">)[:,[</span><span class="mi">4</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>\
             <span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">v3</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">cut</span><span class="p">)</span>

<span class="n">mat</span><span class="o">=</span><span class="n">cat</span><span class="o">.</span><span class="n">Matcher</span><span class="p">()</span>
<span class="n">imatch</span><span class="p">,</span><span class="n">imiss</span><span class="p">,</span><span class="n">d2d</span><span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">match_within</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span> <span class="c1">#,dist=1./3600)</span>
<span class="n">fits_funcs</span><span class="o">.</span><span class="n">set_mags</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<span class="n">fits_funcs</span><span class="o">.</span><span class="n">set_mags</span><span class="p">(</span><span class="n">v3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Matched: 86162/88034 objects
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">plots</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">k</span><span class="o">=</span><span class="n">plots</span><span class="o">.</span><span class="n">Kaylans</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">imatch</span><span class="p">,</span>\
                <span class="n">ref_name</span><span class="o">=</span><span class="s1">&#39;v2&#39;</span><span class="p">,</span><span class="n">obs_name</span><span class="o">=</span><span class="s1">&#39;v3&#39;</span><span class="p">,</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [31]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d</span><span class="o">=</span><span class="n">plots</span><span class="o">.</span><span class="n">Dustins</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">imatch</span><span class="p">,</span><span class="n">d2d</span><span class="p">,</span>\
             <span class="n">ref_name</span><span class="o">=</span><span class="s1">&#39;v2&#39;</span><span class="p">,</span><span class="n">obs_name</span><span class="o">=</span><span class="s1">&#39;v3&#39;</span><span class="p">,</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;Median mw_trans&#39;, &#39;g&#39;, &#39;is&#39;, 0.64602697)
(&#39;Median mw_trans&#39;, &#39;r&#39;, &#39;is&#39;, 0.74504399)
(&#39;Median mw_trans&#39;, &#39;z&#39;, &#39;is&#39;, 0.84821224)
(&#39;Raw mean and std of points:&#39;, nan, nan)
(&#39;sig= &#39;, array([], dtype=float32), &#39;len(sig)=&#39;, 0)
(&#39;Median and percentile-based sigma:&#39;, nan, -1)
(&#39;Raw mean and std of points:&#39;, nan, nan)
(&#39;sig= &#39;, array([], dtype=float32), &#39;len(sig)=&#39;, 0)
(&#39;Median and percentile-based sigma:&#39;, nan, -1)
(&#39;Raw mean and std of points:&#39;, 0.028856862, 0.29600513)
(&#39;sig= &#39;, array([ 0.00747771,  0.05404525, -0.18384862, ...,  0.44771522,
        0.30427396,  0.26952279], dtype=float32), &#39;len(sig)=&#39;, 33502)
(&#39;Median and percentile-based sigma:&#39;, 0.018961083, 0.1335631977021694)
(&#39;y=&#39;, array([ nan,  nan,  nan, ...,  nan,  nan,  nan], dtype=float32))
(&#39;I=&#39;, array([], dtype=int64))
(&#39;ybin =&#39;, array([], dtype=float32))
(&#39;Mag bin&#39;, 21.0, 24.0, &#39;band&#39;, &#39;g&#39;, &#39;: IQD is factor&#39;, -0.74130110925280102, &#39;vs expected for Gaussian;&#39;, 0, &#39;points&#39;)
(&#39;y=&#39;, array([ nan,  nan,  nan, ...,  nan,  nan,  nan], dtype=float32))
(&#39;I=&#39;, array([], dtype=int64))
(&#39;ybin =&#39;, array([], dtype=float32))
(&#39;Mag bin&#39;, 21.0, 23.5, &#39;band&#39;, &#39;r&#39;, &#39;: IQD is factor&#39;, -0.74130110925280102, &#39;vs expected for Gaussian;&#39;, 0, &#39;points&#39;)
(&#39;Mag bin&#39;, 16.25, &#39;: IQD is factor&#39;, 2.4620998551269846, &#39;vs expected for Gaussian;&#39;, 1500, &#39;points&#39;)
(&#39;Mag bin&#39;, 16.75, &#39;: IQD is factor&#39;, 2.0272153060447744, &#39;vs expected for Gaussian;&#39;, 1799, &#39;points&#39;)
(&#39;Mag bin&#39;, 17.25, &#39;: IQD is factor&#39;, 1.3147107804448173, &#39;vs expected for Gaussian;&#39;, 2296, &#39;points&#39;)
(&#39;Mag bin&#39;, 17.75, &#39;: IQD is factor&#39;, 0.79141734790230589, &#39;vs expected for Gaussian;&#39;, 2659, &#39;points&#39;)
(&#39;Mag bin&#39;, 18.25, &#39;: IQD is factor&#39;, 0.51687610963758235, &#39;vs expected for Gaussian;&#39;, 3136, &#39;points&#39;)
(&#39;Mag bin&#39;, 18.75, &#39;: IQD is factor&#39;, 0.34744157986493845, &#39;vs expected for Gaussian;&#39;, 3754, &#39;points&#39;)
(&#39;Mag bin&#39;, 19.25, &#39;: IQD is factor&#39;, 0.25580123825926171, &#39;vs expected for Gaussian;&#39;, 4302, &#39;points&#39;)
(&#39;Mag bin&#39;, 19.75, &#39;: IQD is factor&#39;, 0.20186076945589429, &#39;vs expected for Gaussian;&#39;, 4953, &#39;points&#39;)
(&#39;Mag bin&#39;, 20.25, &#39;: IQD is factor&#39;, 0.16378717172949639, &#39;vs expected for Gaussian;&#39;, 5657, &#39;points&#39;)
(&#39;Mag bin&#39;, 20.75, &#39;: IQD is factor&#39;, 0.13825173301170635, &#39;vs expected for Gaussian;&#39;, 6396, &#39;points&#39;)
(&#39;Mag bin&#39;, 21.25, &#39;: IQD is factor&#39;, 0.12707267113487436, &#39;vs expected for Gaussian;&#39;, 7494, &#39;points&#39;)
(&#39;Mag bin&#39;, 21.75, &#39;: IQD is factor&#39;, 0.12054514534353583, &#39;vs expected for Gaussian;&#39;, 8355, &#39;points&#39;)
(&#39;Mag bin&#39;, 22.25, &#39;: IQD is factor&#39;, 0.11934734965750081, &#39;vs expected for Gaussian;&#39;, 6876, &#39;points&#39;)
(&#39;Mag bin&#39;, 22.75, &#39;: IQD is factor&#39;, 0.10722030297782431, &#39;vs expected for Gaussian;&#39;, 778, &#39;points&#39;)
(&#39;y=&#39;, array([ 0.13694769, -0.42085388,  0.05377205, ..., -0.30433059,
       -0.26951423, -0.09043867], dtype=float32))
(&#39;I=&#39;, array([    5,     6,    14, ..., 86158, 86159, 86160]))
(&#39;ybin =&#39;, array([-0.00747961, -0.05404866, -0.12845783, ..., -0.44715759,
       -0.30433059, -0.26951423], dtype=float32))
(&#39;Mag bin&#39;, 21.0, 22.5, &#39;band&#39;, &#39;z&#39;, &#39;: IQD is factor&#39;, 0.12218840718767411, &#39;vs expected for Gaussian;&#39;, 22725, &#39;points&#39;)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [375]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">plots</span>
<span class="n">d</span><span class="o">=</span><span class="n">plots</span><span class="o">.</span><span class="n">Dustins</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">imatch</span><span class="p">,</span><span class="n">d2d</span><span class="p">,</span><span class="n">plot_all</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [397]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>

<span></span><span class="n">mat</span><span class="o">.</span><span class="n">match_within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ref</span><span class="p">,</span><span class="n">obs</span><span class="p">,</span><span class="n">dist</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3600</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[397]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[1, 2, 3, 4]
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [456]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Take v2 and shift everything by 1/3 pix in dec</span>
<span class="n">fits_funcs</span><span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">CatalogueFuncs</span><span class="p">()</span>
<span class="n">v4</span><span class="o">=</span><span class="n">fits_funcs</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;v2_cats.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [457]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">third_pix</span><span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mf">0.262</span><span class="o">/</span><span class="mi">3600</span>
<span class="n">v4</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span><span class="n">v4</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dec&#39;</span><span class="p">)</span><span class="o">+</span><span class="n">third_pix</span><span class="p">)</span>
<span class="n">fits_funcs</span><span class="o">.</span><span class="n">set_extra_data</span><span class="p">(</span><span class="n">v4</span><span class="p">)</span>
<span class="n">mat</span><span class="o">=</span><span class="n">cat</span><span class="o">.</span><span class="n">Matcher</span><span class="p">()</span>
<span class="n">imatch</span><span class="p">,</span><span class="n">imiss</span><span class="p">,</span><span class="n">d2d</span><span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">match_within</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v4</span><span class="p">)</span> <span class="c1">#,dist=1./3600)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Matched: 165699/165699 objects
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [460]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">d2d</span> <span class="o">*</span> <span class="mf">3600.</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span><span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/nb_theValidator_20_0.png" src="../_images/nb_theValidator_20_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [396]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">plots</span>
<span class="n">k</span><span class="o">=</span><span class="n">plots</span><span class="o">.</span><span class="n">Kaylans</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">imatch</span><span class="p">,</span><span class="n">plot_all</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">mytype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PSF&#39;</span><span class="p">,</span><span class="s1">&#39;SIMP&#39;</span><span class="p">,</span><span class="s1">&#39;DEV&#39;</span><span class="p">,</span><span class="s1">&#39;COMP&#39;</span><span class="p">]:</span>
    <span class="n">k</span><span class="o">.</span><span class="n">stacked_confusion_matrix</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span> <span class="n">imatch</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">]</span> <span class="p">],</span><span class="n">v3</span><span class="p">[</span> <span class="n">imatch</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">]</span> <span class="p">],</span>\
                               <span class="n">ref_name</span><span class="o">=</span><span class="s1">&#39;v2&#39;</span><span class="p">,</span><span class="n">obs_name</span><span class="o">=</span><span class="s1">&#39;v3&#39;</span><span class="p">,</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>\
                               <span class="n">band</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="n">mytype</span><span class="o">=</span><span class="n">mytype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [486]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">plots</span>
<span class="n">k</span><span class="o">=</span><span class="n">plots</span><span class="o">.</span><span class="n">Kaylans</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">imatch</span><span class="p">,</span><span class="n">plot_all</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="c1"># k.barchart(v2,v3,\</span>
<span class="c1">#            ref_name=&#39;v2&#39;,obs_name=&#39;v3&#39;,savefig=True,prefix=&#39;alldata&#39;)</span>
<span class="c1"># k.barchart(v2[ imatch[&#39;ref&#39;]],v3[imatch[&#39;obs&#39;]],\</span>
<span class="c1">#            ref_name=&#39;v2&#39;,obs_name=&#39;v3&#39;,savefig=True,prefix=&#39;matchedonly&#39;)</span>
<span class="n">k</span><span class="o">.</span><span class="n">delta_mag_vs_mag</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span> <span class="n">imatch</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">]],</span><span class="n">v3</span><span class="p">[</span><span class="n">imatch</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">]],</span>\
            <span class="n">ref_name</span><span class="o">=</span><span class="s1">&#39;v2&#39;</span><span class="p">,</span><span class="n">obs_name</span><span class="o">=</span><span class="s1">&#39;v3&#39;</span><span class="p">,</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [480]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">plots</span>
<span class="n">d</span><span class="o">=</span><span class="n">plots</span><span class="o">.</span><span class="n">Dustins</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">imatch</span><span class="p">,</span><span class="n">d2d</span><span class="p">,</span><span class="n">plot_all</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">match_distance</span><span class="p">(</span><span class="n">d2d</span><span class="p">,</span><span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">savefig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1"># imatch_2,imiss_2,d2d_2= mat.match_within(v3,v2)</span>
<span class="c1"># d.match_/distance(d2d_2,range=(0,0.2),savefig=True,prefix=&#39;2_&#39;)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [442]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">catalogues</span>
<span class="n">mat</span><span class="o">=</span><span class="n">catalogues</span><span class="o">.</span><span class="n">Matcher</span><span class="p">()</span>
<span class="n">d</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;v2_auto&#39;</span><span class="p">,</span><span class="s1">&#39;v3_auto&#39;</span><span class="p">,</span><span class="s1">&#39;v2v3_cross&#39;</span><span class="p">]:</span>
    <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;v2v3_cross&#39;</span><span class="p">:</span>
        <span class="n">tup</span><span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">nearest_neighbors_within</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">within</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3600</span><span class="p">,</span><span class="n">min_nn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">max_nn</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;v2_auto&#39;</span><span class="p">:</span>
        <span class="n">tup</span><span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">nearest_neighbors_within</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">within</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3600</span><span class="p">,</span><span class="n">min_nn</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">max_nn</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;v3_auto&#39;</span><span class="p">:</span>
        <span class="n">tup</span><span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">nearest_neighbors_within</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">within</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3600</span><span class="p">,</span><span class="n">min_nn</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">max_nn</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;ref&#39;</span><span class="p">],</span><span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;obs&#39;</span><span class="p">],</span><span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;dist&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">tup</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
within 1arcsec, nn=2, 21119/165699
within 1arcsec, nn=3, 1155/165699
within 1arcsec, nn=4, 4/165699
within 1arcsec, nn=2, 20958/163769
within 1arcsec, nn=3, 1120/163769
within 1arcsec, nn=4, 0/163769
within 1arcsec, nn=1, 161755/165699
within 1arcsec, nn=2, 20778/165699
within 1arcsec, nn=3, 1113/165699
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [443]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;dist&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[443]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>{&#39;1&#39;: array([  2.02415355e-06,   5.88182857e-07,   8.29685969e-07, ...,
          5.03871223e-06,   3.26318253e-06,   5.21471035e-05]),
 &#39;2&#39;: array([  6.24419260e-06,   1.95633020e-06,   7.03720806e-07, ...,
          1.30326732e-05,   8.14032630e-06,   9.12097698e-06]),
 &#39;3&#39;: array([  1.13596996e-06,   8.55659268e-06,   4.83908940e-06, ...,
          3.07454543e-06,   2.22440656e-06,   1.56397319e-05])}
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [444]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;v2v3_cross&#39;</span>
<span class="n">dists</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">cnt</span><span class="p">,</span><span class="n">nn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;ref&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
    <span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">dists</span><span class="p">[</span><span class="n">nn</span><span class="p">]</span><span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;dist&#39;</span><span class="p">][</span><span class="n">nn</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dists</span><span class="p">[</span><span class="n">nn</span><span class="p">]</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;dist&#39;</span><span class="p">][</span><span class="n">nn</span><span class="p">],</span> <span class="n">dists</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;nn=</span><span class="si">%s</span><span class="s1">, len(dists[nn])=</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nn</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dists</span><span class="p">[</span><span class="n">nn</span><span class="p">])))</span>
<span class="c1">#     if str(int(nn)-1) in d[key][&#39;ref&#39;].keys():</span>
<span class="c1">#     distsplt.hist(d[key][&#39;dist&#39;][nn]*3600,20,range=(0.01,0.1),normed=True)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
nn=1, len(dists[nn])=161755
nn=2, len(dists[nn])=182533
nn=3, len(dists[nn])=183646
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [449]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span> <span class="n">dists</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">dists</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[  2.02415355e-06   5.88182857e-07   8.29685969e-07 ...,   5.03871223e-06
   3.26318253e-06   5.21471035e-05]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[449]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(array([ 63.81948522,  42.94800705,  29.73376534,  20.2379658 ,
         14.23796097,  11.0887618 ,   8.31370218,   6.08493222,
          4.00076833,   2.41010141,   1.80872372,   1.39785882,
          1.20964137,   0.94338255,   0.82172981,   0.63351237,
          0.55088032,   0.46136227,   0.40856957]),
 array([ 0.01      ,  0.01473684,  0.01947368,  0.02421053,  0.02894737,
         0.03368421,  0.03842105,  0.04315789,  0.04789474,  0.05263158,
         0.05736842,  0.06210526,  0.06684211,  0.07157895,  0.07631579,
         0.08105263,  0.08578947,  0.09052632,  0.09526316,  0.1       ]))
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [455]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;v2v3_cross&#39;</span>
<span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="k">print</span> <span class="n">bins</span>
<span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;ref&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="k">print</span> <span class="n">nn</span>
    <span class="n">hist</span><span class="p">,</span><span class="n">bj</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">dists</span><span class="p">[</span><span class="n">nn</span><span class="p">]</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">binc</span><span class="o">=</span> <span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">+</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">binc</span><span class="p">,</span><span class="n">hist</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">binc</span><span class="p">,</span><span class="n">hist</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">bins</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
<span class="c1">#     plt.hist(dists[nn]*3600,20,range=(0.01,0.1),normed=True)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 0.01        0.01473684  0.01947368  0.02421053  0.02894737  0.03368421
  0.03842105  0.04315789  0.04789474  0.05263158  0.05736842  0.06210526
  0.06684211  0.07157895  0.07631579  0.08105263  0.08578947  0.09052632
  0.09526316  0.1       ]
3
[ 0.01236842  0.01710526  0.02184211  0.02657895  0.03131579  0.03605263
  0.04078947  0.04552632  0.05026316  0.055       0.05973684  0.06447368
  0.06921053  0.07394737  0.07868421  0.08342105  0.08815789  0.09289474
  0.09763158] [ 62.63252882  42.8880365   29.57574992  20.10839082  14.38198818
  11.10090343   8.47563574   6.38621858   4.1068544    2.56728386
   1.90146959   1.52557445   1.28564137   1.03771053   0.88975181
   0.709802     0.59383435   0.4918628    0.45187395]
2
[ 0.01236842  0.01710526  0.02184211  0.02657895  0.03131579  0.03605263
  0.04078947  0.04552632  0.05026316  0.055       0.05973684  0.06447368
  0.06921053  0.07394737  0.07868421  0.08342105  0.08815789  0.09289474
  0.09763158] [ 62.67751122  42.89012209  29.62673379  20.09335893  14.39265842
  11.11958673   8.4705324    6.33679562   4.09838497   2.55847117
   1.88614279   1.52381013   1.28628094   1.01855737   0.88570206
   0.71258756   0.59382297   0.49116205   0.44888991]
1
[ 0.01236842  0.01710526  0.02184211  0.02657895  0.03131579  0.03605263
  0.04078947  0.04552632  0.05026316  0.055       0.05973684  0.06447368
  0.06921053  0.07394737  0.07868421  0.08342105  0.08815789  0.09289474
  0.09763158] [ 63.81948522  42.94800705  29.73376534  20.2379658   14.23796097
  11.0887618    8.31370218   6.08493222   4.00076833   2.41010141
   1.80872372   1.39785882   1.20964137   0.94338255   0.82172981
   0.63351237   0.55088032   0.46136227   0.40856957]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[455]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(0.0, 70.0)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/nb_theValidator_28_2.png" src="../_images/nb_theValidator_28_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [413]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1">#,figsize=(4,8),sharex=True)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># for cnt,key in zip(range(3),[&#39;v2_auto&#39;,&#39;v3_auto&#39;,&#39;v2v3_cross&#39;]):</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
<span class="n">key</span><span class="o">=</span><span class="s1">&#39;v2_auto&#39;</span>
<span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;ref&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;dist&#39;</span><span class="p">][</span><span class="n">nn</span><span class="p">]</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;nn=&#39;</span><span class="o">+</span><span class="n">nn</span><span class="p">,</span>\
                <span class="n">normed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>


<span class="c1">#     hist[band],bins= np.histogram(chi[band][imag],\</span>
<span class="c1">#                             range=(low,hi),bins=50,normed=True)</span>
<span class="c1">#     db= (bins[1:]-bins[:-1])/2</span>
<span class="c1">#     binc[band]= bins[:-1]+db</span>
<span class="c1">#     ax[cnt].step(binc[band],hist[band], where=&#39;mid&#39;,c=&#39;b&#39;,lw=2) #label=&quot;%.1f &lt; mag &lt; %.1f&quot; % (b_low,b_hi))</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[413]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.legend.Legend at 0x7fe6246eaa90&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/nb_theValidator_29_1.png" src="../_images/nb_theValidator_29_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [377]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d</span><span class="o">.</span><span class="n">match_distance</span><span class="p">(</span><span class="n">d2d</span><span class="p">,</span><span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.15</span><span class="p">),</span><span class="n">savefig</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">k</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/nb_theValidator_30_0.png" src="../_images/nb_theValidator_30_0.png" />
</div>
</div>
</div>
<div class="section" id="Cosmos-comparison">
<h1>Cosmos comparison<a class="headerlink" href="#Cosmos-comparison" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [363]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fits_funcs</span><span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">CatalogueFuncs</span><span class="p">()</span>
<span class="n">c40</span><span class="o">=</span><span class="n">fits_funcs</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;cosmos_40_tractor_list.txt&#39;</span><span class="p">)</span>
<span class="n">c41</span><span class="o">=</span><span class="n">fits_funcs</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s1">&#39;cosmos_41_tractor_list.txt&#39;</span><span class="p">)</span>
<span class="n">mat</span><span class="o">=</span><span class="n">cat</span><span class="o">.</span><span class="n">Matcher</span><span class="p">()</span>
<span class="n">cmatch</span><span class="p">,</span><span class="n">imiss</span><span class="p">,</span><span class="n">c_d2d</span><span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">match_within</span><span class="p">(</span><span class="n">c40</span><span class="p">,</span><span class="n">c41</span><span class="p">)</span> <span class="c1">#,dist=1./3600)</span>
<span class="n">fits_funcs</span><span class="o">.</span><span class="n">set_extra_data</span><span class="p">(</span><span class="n">c40</span><span class="p">)</span>
<span class="n">fits_funcs</span><span class="o">.</span><span class="n">set_extra_data</span><span class="p">(</span><span class="n">c41</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Matched: 87520/102554 objects
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [369]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">plots</span>
<span class="n">e</span><span class="o">=</span><span class="n">plots</span><span class="o">.</span><span class="n">EnriqueCosmos</span><span class="p">(</span><span class="n">c40</span><span class="p">,</span><span class="n">c41</span><span class="p">,</span><span class="n">cmatch</span><span class="p">,</span><span class="n">ref_name</span><span class="o">=</span><span class="s1">&#39;40&#39;</span><span class="p">,</span><span class="n">obs_name</span><span class="o">=</span><span class="s1">&#39;41&#39;</span><span class="p">,</span><span class="n">savefig</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;Fit to Gaussian random draws:&#39;, (array([ 0.00891742,  1.00578756]), array([[  2.45959736e-05,  -7.81325000e-12],
       [ -7.81325000e-12,   1.63973034e-05]])))
band,w= r 2 40 41
 Cov[r-z,r-g]=[0.54,0.44]
[-0.08922685  1.42966662] $\sigma$=1.84 , 1.5
 Cov[r-z,r-g]=[-0.04,0.05]
[-0.07282076  0.99981886] $\sigma$=1.01 , 1.02
[-0.07282076  0.99981886] (-0.067757026787108418, 1.011918172091693) (-0.049335577, 1.017967337369919)
band,w= z 4 40 41
 Cov[z-r,z-g]=[0.54,0.37]
[ 0.00368858  1.44342443] $\sigma$=1.8 , 1.49
 Cov[z-r,z-g]=[-0.04,0.0]
[ 0.03681704  1.20343182] $\sigma$=1.24 , 1.21
[ 0.03681704  1.20343182] (0.0015381650357208785, 1.2444712383302234) (0.01935184, 1.2096207261085508)
band,w= g 1 40 41
 Cov[g-r,g-z]=[0.44,0.37]
[-0.04246938  1.16099443] $\sigma$=1.28 , 1.17
 Cov[g-r,g-z]=[0.05,0.0]
[-0.09388157  1.03306774] $\sigma$=1.06 , 1.04
[-0.09388157  1.03306774] (-0.026479746719942417, 1.063553463659239) (-0.043351516, 1.0403990864753725)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.figure.Figure at 0x7fe620419350&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/nb_theValidator_33_2.png" src="../_images/nb_theValidator_33_2.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [367]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">plots</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014-2018, Kaylan Burleigh, John Moustakas.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>